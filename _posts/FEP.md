The free energy principle and active inference theory, developed by Karl Friston, provide a theoretical framework for understanding perception, action, and learning in biological and artificial systems. 

### Free Energy Principle

The free energy principle is a mathematical principle of information physics, suggesting that the brain reduces surprise or uncertainty by making predictions based on internal models. It establishes that the dynamics of physical systems minimize a quantity known as surprisal or its variational upper bound, called free energy. This principle is used in Bayesian approaches to brain function and is formally related to variational Bayesian methods. The free energy principle is a "first principles" approach to understanding behavior and the brain, framed in terms of a single imperative to minimize free energy.

The free energy principle relates to the brain's ability to make predictions by suggesting that the brain minimizes surprise or uncertainty by making predictions based on internal models and updating them using sensory input. This principle integrates Bayesian inference with active inference, where actions are guided by predictions and sensory feedback refines them. In this framework, perception is seen as the minimization of free energy with respect to sensory input, and action is the minimization of the same free energy with respect to outbound action information. Therefore, the free energy principle provides a theoretical basis for understanding how the brain's internal models are used to make predictions and minimize surprise, which is essential for adaptive behavior and learning.

The relationship between the free energy principle and predictive coding is that the free energy principle provides a theoretical framework for understanding the brain's function, while predictive coding is a specific implementation of the principles entailed by the free energy principle. Predictive coding is a particular form of message passing in hierarchical Bayesian models, where predictions are sent down the hierarchy and prediction errors are sent up. The free energy principle subsumes predictive coding as a special case, where optimizing model parameters through a gradient descent on the time integral of free energy reduces to associative or Hebbian plasticity and is associated with synaptic plasticity in the brain. Therefore, while predictive coding is a specific computational implementation, the free energy principle provides a more general and unifying perspective on brain function, perception, and learning.

#### Minimizing free energy

The concept of "minimizing free energy" revolves around reducing the error or surprise generated by interactions with the external environment, including one's own body. Free energy serves as a measure of surprise, equating to the negative logarithm of the evidence for the system's model. The system consistently strives to minimize surprise, aiming to decrease uncertainty in its sensory exchanges with the world. Although no model can perfectly represent the external world, some level of uncertainty is necessary for system optimization. Excessive uncertainty or error contradicts the system's goal of adhering to its attractor states, defining what it is.

The free energy principle dictates that free energy must be actively constrained to ensure the minimization of expected surprise or the maximization of model evidence. Minimizing free energy corresponds to reducing the error in the system's predictions about the world, ultimately enhancing the precision of the system's capacity to model its environment—a concept succinctly termed self-evidencing.

Models of perception grounded in prediction, stemming from Helmholtz's notion of unconscious inference, have evolved over time. These models focus on top-down inferences about one's environment. State-based predictive models fall under the umbrella of "predictive processing," where the brain is likened to a scientist making observations, collecting data, and generating hypotheses based on available information.

Predictive processing redefines the brain as a system driven by top-down and bottom-up neural networks, aiming to signal predictions and minimize prediction error. Reentrant loops, providing feedback from higher brain regions to sensory areas, propagate predictions about sensory input. If the prediction sufficiently accounts for the signal, the error is explained away; otherwise, the predictive model is revised. This process can be described in terms of Bayesian belief updating, involving the reciprocal exchange of top-down predictions and bottom-up prediction errors. Bidirectional signals throughout the cortical hierarchy build generative models about the sensed world.

### Active Inference Theory

Active inference is based on the premise that everything minimizes variational free energy, leading to simple update rules for action, perception, policy selection, learning, and the encoding of uncertainty. It characterizes perception as the minimization of free energy with respect to sensory input and action as the minimization of the same free energy with respect to outbound action information. Active inference is a way of understanding sentient behavior, emphasizing the implications of the free energy principle for understanding how the brain and behavior are used across multiple disciplines.

In summary, the free energy principle and active inference theory provide a unifying framework for understanding biological and artificial systems' behavior, perception, and learning, based on the minimization of free energy or surprisal. These theories have implications for fields such as neuroscience, cognitive science, and artificial intelligence.


Active inference is a fundamental concept within the free energy principle, serving as a "first principles" approach to understanding behavior and the brain. It is framed in terms of a single imperative to minimize free energy, which is a key tenet of the free energy principle. Active inference integrates Bayesian inference with action, where actions are guided by predictions, and sensory feedback refines them. This approach characterizes perception, planning, and action in terms of probabilistic inference, emphasizing the brain's constant effort to minimize surprise or uncertainty by updating internal models based on sensory input. Therefore, active inference is a central component of the free energy principle, providing a framework for understanding how the brain's ability to make predictions and take actions is rooted in minimizing free energy and reducing surprise.

Active inference is a "first principles" approach to understanding behavior and the brain, framed in terms of a single imperative to minimize free energy, which is a key tenet of the free energy principle. It integrates Bayesian inference with action, where actions are guided by predictions, and sensory feedback refines them. This approach characterizes perception, planning, and action in terms of probabilistic inference, emphasizing the brain's constant effort to minimize surprise or uncertainty by updating internal models based on sensory input. Therefore, active inference is a central component of the free energy principle, providing a framework for understanding how the brain's ability to make predictions and take actions is rooted in minimizing free energy and reducing surprise.

In the context of active inference, the variational free energy objective is a central concept. It is the functional minimized by the agent in active inference, with the aim of learning a generative model of the world based on past experience to predict and avoid surprising states in the future. The variational free energy is a principled metric that scores the surprise or uncertainty associated with a belief in light of observed or expected outcomes. It serves as a key component in the active inference framework, guiding the agent's behavior and learning processes based on the minimization of free energy to reduce surprise and uncertainty. Therefore, the variational free energy objective plays a crucial role in active inference, aligning with the overarching principle of minimizing free energy to enable adaptive and predictive behavior.

Cognitive systems do not passively observe the world; instead, cognitive agents actively engage with and sample the environment to test their predictions regarding the causes of sensory data. The concept of active inference, derived from the free energy principle, outlines how agents aim to minimize variational free energy by testing and updating generative models through sequences of actions predicted to yield preferred outcomes, known as action policies.

Active inference presupposes that agents have preferences for particular states that minimize uncertainty or expected surprise, as surprising states are inherently aversive. Action policies and the subsequent adjustment of generative models are directed toward achieving preferred sensory outcomes and avoiding non-preferred ones.

In active inference, agentic preferences over sensory outcomes are typically treated as prior predictions, referred to as prior preferences. If the actual sensory outcome deviates from the preferred outcomes, it is considered surprising. Agents, when making decisions about potential action sequences, calibrate the expected surprise generated by different courses of action. After calibration, agents can infer the most likely action, a process sometimes described as planning or control as inference.

The attainment of preferred outcomes through action policies involves minimizing the expected divergence between preferred sensory outcomes and those anticipated when committing to a specific plan. The crucial aspect is that actions are chosen based on the agent's estimation of the likelihood of generating preferred sensory outcomes, often aligning with the agent's existing world model.

### Predictive processing and the free energy principle

The relationship between predictive processing and the free energy principle is a topic of significant interest. Predictive processing, a theory of brain function, suggests that the brain is constantly generating and updating internal models to make predictions about the world. These predictions are compared with sensory input, and any disparities result in prediction errors, which drive learning and adaptation.

In the context of the free energy principle, which posits that the brain minimizes surprise or uncertainty by making and updating predictions based on internal models, there is a strong connection to predictive processing. The free energy principle can be seen as providing a theoretical foundation for understanding the mechanisms underlying predictive processing. It has been argued that the free energy principle imposes an important constraint, namely variational free energy, which is related to the minimization of long-term average prediction error in the context of predictive processing.

Furthermore, the free energy principle and predictive processing share a common emphasis on the brain as a prediction machine, constantly seeking to minimize surprise or prediction error. This shared emphasis has led to efforts to integrate the two frameworks, with the free energy principle providing a unifying perspective that can encompass and explain the mechanisms proposed by predictive processing.

In summary, the relationship between predictive processing and the free energy principle is one of mutual relevance and potential integration. Both frameworks are concerned with how the brain makes and updates predictions to minimize surprise, and efforts are being made to reconcile and integrate these perspectives to provide a more comprehensive account of brain function.


The free energy principle and predictive accounts aim to elucidate the functioning of the brain. Predictive processing can be viewed as an application of the free energy principle, specifically in terms of predictive coding schemes. These applications depict the brain as a continuous modeler of the world to gain understanding. While the free energy principle describes fundamental laws in biological systems, predictive processing is often applied as a process theory for psychology and situated cognition.

Although the free energy principle primarily focuses on system dynamics, it can be applied to biological phenomena at various scales, from microscopic to psychological. At the level of human psychology, belief formation serves as a pertinent example. Under the free energy principle, "beliefs" align with probability distributions over external states, parameterized by internal representations. Belief formation, a process where the brain learns about the world based on prior observations, is synonymous with predictive processing, which describes belief formation through updating and developing priors.

The free energy principle and predictive processing are interconnected in their descriptions of belief formation concerning learning and perceptual inference. The key distinction lies in the free energy principle providing a foundational method that seeks to dissolve disciplinary boundaries. Together, these approaches not only elucidate optimal prediction and model generation but also consider how contextual cues influence the probabilities of specific states or outcomes. Importantly, they allow exploration of outcomes resulting from decisions, choices, and actions.


### Bayesian Brain Hypothesis 


The Bayesian brain hypothesis and the free energy principle are closely related. The free energy principle, proposed by Karl Friston, suggests that the brain operates as a prediction machine, constantly minimizing surprise or uncertainty by making and updating predictions based on internal models. This principle integrates Bayesian inference with active inference, where actions are guided by predictions and sensory feedback refines them. The Bayesian brain hypothesis, on the other hand, posits that the brain is equipped with an internal (or "generative") model of the environment, which specifies a "recipe" for generating sensory observations from hidden states. This internal model may not be represented explicitly anywhere in the brain; the claim is that the brain computes "as if" it had an internal model.

In short, the free energy principle subsumes the Bayesian brain hypothesis, and the two are closely aligned in their emphasis on the brain as a prediction machine that seeks to minimize surprise or prediction error. The free energy principle provides a theoretical foundation for understanding the mechanisms underlying the Bayesian brain hypothesis, and both frameworks are concerned with how the brain makes and updates predictions to minimize surprise and uncertainty.


The Bayesian brain hypothesis employs Bayesian probability theory to conceptualize perception as a constructive process based on internal or generative models. The fundamental idea is that the brain possesses a model of the world, which it seeks to optimize using sensory inputs. This perspective views the brain as an inference machine actively predicting and explaining sensations. Central to this hypothesis is a probabilistic model that generates predictions, against which sensory samples are tested to update beliefs about their causes. The generative model consists of a likelihood (probability of sensory data given their causes) and a prior (a priori probability of those causes). Perception, in this framework, involves inverting the likelihood model to access the posterior probability of causes given sensory data, a process equivalent to minimizing the difference between recognition and posterior densities to suppress free energy.

The Bayesian brain hypothesis faces questions about the form of the generative model and how it manifests in the brain. Hierarchical generative models address criticisms by optimizing priors within a hierarchical structure. In hierarchical models, causes at one level generate subordinate causes at a lower level, with sensory data generated at the lowest level. The optimization of empirical priors in hierarchical models is informed by sensory data, resulting in an internally consistent representation of sensory causes across multiple levels.

Another issue concerns the form of the recognition density encoded by physical attributes of the brain, such as synaptic activity. The encoding of density by sufficient statistics places constraints on recognition schemes, ranging from free-form schemes to simpler forms like the Gaussian assumption. The Gaussian form, known as the Laplace assumption, aligns with predictive coding, a popular framework for understanding neuronal message passing in cortical hierarchies.

In summary, the Bayesian brain hypothesis suggests that the brain is an inference engine striving to optimize probabilistic representations of the causes of sensory input. The optimization is facilitated by the variational free-energy principle, which is implemented through various schemes involving message passing or belief propagation among brain areas or units. This connection allows the integration of the free-energy principle with information theory, providing a comprehensive understanding of sensory processing.

### Adaptive Priors and the Bayesian Brain 

The adaptive priors in the Bayesian brain hypothesis refer to the question of whether these priors are innate or learned. The hypothesis suggests that the brain is equipped with an internal (or "generative") model of the environment, which specifies a "recipe" for generating sensory observations from hidden states. These priors, whether innate or learned, provide the brain with adapted prior guesses when processing sensory information, enabling it to make predictions and inferences about the environment. The debate over the origin of these priors, whether they are innate or acquired through learning, is an ongoing topic of research and discussion within the framework of the Bayesian brain hypothesis.

The adaptive nature of these priors is essential for the brain to effectively infer sensory contingencies and exhibit adaptive behavior. The Bayesian brain hypothesis, which is closely related to the free energy principle, emphasizes that the brain is constantly updating and refining its internal beliefs to align with the current state of the environment. This process of adaptive inference enables the brain to minimize surprise and uncertainty, ultimately guiding behavior and decision-making in a changing and uncertain world.

Adaptive priors play a crucial role in helping the brain make predictions by providing it with prior expectations that are continuously updated based on sensory input and past experience. These priors, whether innate or learned, enable the brain to form adapted prior guesses when processing sensory information, allowing it to make predictions and inferences about the environment. The adaptive nature of these priors is essential for the brain to effectively infer sensory contingencies and exhibit adaptive behavior. They guide the brain's action-perception cycles toward adaptive and unsurprising states, ultimately contributing to the brain's ability to minimize surprise and uncertainty. Therefore, adaptive priors serve as a foundational component that enables the brain to make accurate predictions and navigate a changing and uncertain world.

Individuals are adapted or optimized to their environment, either through evolution or daily learning, resulting in expectations encoded by neuronal form and activity. While individual expectations may differ, there is a need to inherit some aspect of these expectations to conserve the physical form across generations. The Bayesian prior beliefs play a crucial role in this context, representing expectations about the sensory experiences expected in the world.

The Free Energy Principle (FEP) proposes that species-typical patterns of cognition and behavior can be explained through adaptive priors—inherit expectations about the causal structure of the world shaped by evolution and life's characteristic properties. The FEP posits that living systems must minimize variational free energy to reduce the entropy of sensory and physiological states, ensuring their survival. Variational free energy is an information theoretic quantity limiting the entropy of a generative model entailed by the state of a biological system.

Living systems, as per the FEP, actively avoid surprising phase-transitions by minimizing the entropy of their sensory and physical states, exhibiting local ergodicity. This propensity to minimize surprise is a consequence of natural selection, favoring systems capable of avoiding phase-transitions. The ability to repeatedly return to a limited set of unsurprising states delays the deleterious effects of dissipative processes.

Biological systems indirectly reduce surprise by minimizing free energy, using sensations and predictions based on the hierarchical generative model encoded in internal states. The FEP generalizes the theory of predictive coding, suggesting that living beings can minimize surprise through changes in predictions by altering internal states (perception and learning) or by changing their relation with the environment (action). Action and perception operate reciprocally to maintain homeostasis and optimize an organism's generative model of the world.

Minimizing free energy means inducing an upper bound on surprise through predictions and optimizing brain activity and connectivity, involving action, perception, and learning. This process, mathematically equivalent to maximizing Bayesian model evidence, compels individuals to make Bayesian inferences about their environment. The optimization of world models occurs through evolution, neurodevelopment, and learning. The discussion then transitions to the role of prior beliefs in shaping predictions, behavior, and the hierarchical structure of the brain.

### Implications for Theorizing and Research in Psychology


The Hierarchical Mechanistic Mind emphasizes the importance of extending the principle of free-energy minimization across all areas of psychological inquiry. In neuroscience, the focus has traditionally been on fourth-level mechanistic phenomena, such as perception, action, attention, and learning. Support for the Free Energy Principle (FEP) comes from computer simulations, visual system studies, and brain microcircuit analyses. Researchers use simulations, fMRI, and EEG to apply computational dynamic causal models, explaining neural responses to unpredictable stimuli and complex phenomena like insight and curiosity.

While progress has been made in neuroscience, psychologists have been slow to utilize the explanatory power of the FEP. However, some have explored its relevance to various psychological phenomena, such as anxiety, emotion, illusions, delusions, hallucinations, and consciousness. The FEP aligns with ecological psychology principles, emphasizing the reciprocal relationship between organisms and their environment, particularly the concept of affordance.

The FEP also aligns with representationalism, as free-energy is defined in relation to a Bayesian belief about hidden causes in the environment. Active inference, rooted in the FEP, has been applied to reinforcement learning, avoiding circularity issues present in classical approaches. It formulates utility based on adaptive and empirical priors acquired over nested timescales, addressing deep problems in traditional approaches.

At the social psychology level, the FEP has inspired models explaining mentalizing and self- and other-representations. Predictive coding is proposed to explain mentalizing, with estimations used to predict others' behaviors. The FEP has been leveraged to explain self- and other-representations as heuristics reducing uncertainty in social interactions. Beliefs about likely social outcomes are weighted by their precision and updated with experience.

Extending beyond social cognition, the FEP has been applied to interpersonal behaviors like dyadic conversation. Communication is seen as a means to resolve uncertainty by adopting a shared narrative, enabling actors to predict each other's sensations and minimize mutual prediction errors. Finally, the FEP has been applied to large-scale sociocultural phenomena, explaining how shared expectations in social groups become encoded neuronally as high-level priors, guiding cooperative action and reducing uncertainty at individual and group levels.


### Refrences

- https://gershmanlab.com/pubs/free_energy.pdf
- https://www.uab.edu/medicine/cinl/images/KFriston_FreeEnergy_BrainTheory.pdf
- https://www.fil.ion.ucl.ac.uk/~karl/The%20free-energy%20principle%20-%20a%20rough%20guide%20to%20the%20brain.pdf
- https://en.wikipedia.org/wiki/Free_energy_principle
- https://www.fil.ion.ucl.ac.uk/~karl/A%20free%20energy%20principle%20for%20the%20brain.pdf

- https://arxiv.org/pdf/2207.06415.pdf
- https://www.frontiersin.org/articles/10.3389/frobt.2022.794464
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5167251/
- https://link.springer.com/article/10.1007/s00422-019-00805-w
- https://www.amazon.ca/Active-Inference-Energy-Principle-Behavior/dp/0262045354

- https://link.springer.com/article/10.1007/s11229-023-04292-2
- https://www.fil.ion.ucl.ac.uk/~karl/A%20free%20energy%20principle%20for%20the%20brain.pdf
- ttps://www.frontiersin.org/articles/10.3389/fnbot.2022.844773
- https://www.nature.com/articles/nrn2787

- https://mitpress.mit.edu/9780262045353/active-inference/
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8871280/
- https://direct.mit.edu/books/oa-monograph/5299/Active-InferenceThe-Free-Energy-Principle-in-Mind

- https://osf.io/preprints/psyarxiv/vgw6q/download
- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7713598/
- https://www.jpn.ca/content/47/1/E48
- https://www.frontiersin.org/articles/10.3389/fpsyg.2019.00592
- https://gershmanlab.com/pubs/free_energy.pdf
  
- https://en.wikipedia.org/wiki/Free_energy_principle
- https://gershmanlab.com/pubs/free_energy.pdf
- https://www.uab.edu/medicine/cinl/images/KFriston_FreeEnergy_BrainTheory.pdf
- https://www.researchgate.net/publication/26293527_Predictive_coding_under_the_free-energy_principle
- https://www.fil.ion.ucl.ac.uk/~karl/The%20free-energy%20principle%20-%20a%20rough%20guide%20to%20the%20brain.pdf



- https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5167251/
- https://en.wikipedia.org/wiki/Free_energy_principle
- https://direct.mit.edu/books/oa-monograph/5299/Active-InferenceThe-Free-Energy-Principle-in-Mind
- https://www.fil.ion.ucl.ac.uk/~karl/The%20free-energy%20principle%20-%20a%20rough%20guide%20to%20the%20brain.pdf
- https://link.springer.com/article/10.1007/s10539-022-09864-z


- https://en.wikipedia.org/wiki/Free_energy_principle
- https://gershmanlab.com/pubs/free_energy.pdf
- https://www.uab.edu/medicine/cinl/images/KFriston_FreeEnergy_BrainTheory.pdf
- https://www.fil.ion.ucl.ac.uk/~karl/The%20free-energy%20principle%20-%20a%20rough%20guide%20to%20the%20brain.pdf
- https://www.fil.ion.ucl.ac.uk/~karl/A%20free%20energy%20principle%20for%20the%20brain.pdf
