---
layout: post
categories: posts
title: Free Energy Principle
featured-image: /images/NIb.jpg
tags: [Free Energy Principle, Predictive Processing, Active Inference]
date-string: February 2024
---

### An Introduction to Free Energy Principle

The free energy principle and active inference theory, developed by Karl Friston, provide a theoretical framework for understanding perception, action, and learning in biological and artificial systems. This brief blog post introduces the Free Energy Principle and Active Inference Theory, concepts pioneered by Karl Friston. These theories offer valuable insights into how perception, action, and learning operate in both biological and artificial systems. With a focus on accessibility, this post aims to provide readers with a foundational understanding of these theories, regardless of their background in neuroscience or artificial intelligence. Join us as we explore these fascinating concepts and their implications for understanding the complexities of cognitive processes.

### Free Energy Principle

The Free Energy Principle (FEP) is a mathematical principle of information physics, suggesting that the brain reduces surprise or uncertainty by making predictions based on internal models. According to this theory brain as a physical systems minimize a quantity known as surprise or its variational upper bound, called free energy. The free energy principle is a "first principles" approach to understanding behavior and the brain, framed in terms of a single imperative to minimize free energy. This principle relates to the brain's ability to make predictions by suggesting that the brain minimizes surprise or uncertainty by making predictions based on internal models and updating them using sensory input. This latter integrates Bayesian inference with active inference, where actions are guided by predictions and sensory feedback refines them. In this framework, perception is seen as the minimization of free energy with respect to sensory input, and action is the minimization of the same free energy with respect to outbound action information. Therefore, the free energy principle provides a theoretical basis for understanding how the brain's internal models are used to make predictions and minimize surprise, which is essential for adaptive behavior and learning.

The concept of "minimizing free energy" revolves around reducing the error or surprise generated by interactions with the external environment, including one's own body. Free energy serves as a measure of surprise, equating to the negative logarithm of the evidence for the system's model. The system consistently strives to minimize surprise, aiming to decrease uncertainty in its sensory exchanges with the world. Although no model can perfectly represent the external world, some level of uncertainty is necessary for system optimization. Excessive uncertainty or error contradicts the system's goal of adhering to its attractor states, defining what it is. The free energy principle dictates that surprise must be actively constrained to ensure the maximization of model evidence. Minimizing free energy corresponds to reducing the error in the system's predictions about the world, ultimately enhancing the precision of the system's capacity to model its environment—a concept succinctly termed self-evidencing. Models of perception grounded in prediction, stemming from Helmholtz's notion of unconscious inference, have evolved over time. These models focus on top-down inferences about one's environment. State-based predictive models fall under the umbrella of "predictive processing," where the brain is likened to a scientist making observations, collecting data, and generating hypotheses based on available information.

Predictive processing redefines the brain as a system driven by top-down and bottom-up neural networks, aiming to signal predictions and minimize prediction error. Reentrant loops, providing feedback from higher brain regions to sensory areas, propagate predictions about sensory input. If the prediction sufficiently accounts for the signal, the error is explained away; otherwise, the predictive model is revised. This process can be described in terms of Bayesian belief updating, involving the reciprocal exchange of top-down predictions and bottom-up prediction errors. Bidirectional signals throughout the cortical hierarchy build generative models about the sensed world.


### Predictive Processing (PP) and the Free Energy Principle

Although the free energy principle primarily focuses on system dynamics, it can be applied to biological phenomena at various scales, from microscopic to brain function and psychological phenomena. Predictive processing is a theory of brain function, suggests that the brain is constantly generating and updating internal models to make predictions about the world. These predictions are compared with sensory input, and any disparities result in prediction errors, which drive learning and adaptation. In the context of the free energy principle and the assumption that the brain minimizes surprise or uncertainty by making and updating predictions based on internal models has a strong connection to predictive processing. The free energy principle can be seen as providing a theoretical foundation for understanding the mechanisms underlying predictive processing. It has been argued that the free energy principle imposes an important constraint, which is related to the minimization of long-term average prediction error in the context of predictive processing. In later posts we are going to discuss the relationships between this constraints and phenomena like consciousness and psychopathology.

The free energy principle and predictive processing share a common emphasis on the brain as a prediction machine, constantly seeking to minimize surprise or prediction error. This shared emphasis has led to efforts to integrate the two frameworks, with the free energy principle providing a unifying perspective that can encompass and explain the mechanisms proposed by predictive processing. A useful example at the level of human psychology is belief formation. Under the free energy principle, "beliefs" align with probability distributions over external states, parameterized by internal representations. Belief formation, a process where the brain learns about the world based on prior observations, is synonymous with predictive processing, which describes belief formation through updating and developing priors. The free energy principle and predictive processing are interconnected in their descriptions of belief formation concerning learning and perceptual inference. The key distinction lies in the free energy principle providing a foundational method that seeks to dissolve disciplinary boundaries. Together, these approaches not only clarify optimal prediction and model generation but also highlight how contextual cues influence the probabilities of specific states or outcomes. Importantly, they allow exploration of outcomes resulting from decisions, choices, and actions.

Predictive processing aims to provide both causal and constitutive explanations of cognitive capacities in alignment with the mechanistic approach to explanation. Currently, cognitivist PP offer descriptive and functional analyses, yet they fail to mechanistically explain all components of cognition. Free energy theory extends cognition beyond the organism and blurs the boundaries between cognitive and non-cognitive phenomena.  Explanation in cognitivist PP based on free energy enactivism focuses on describing free energy minimization without considering the structures and mechanisms involved. A mechanistic approach, which identifies relevant components and respects both functional and structural properties, offers a more comprehensive explanation. This approach enables the understanding of how cognitive capacities are realized in different biological systems by identifying the structures and processes underlying prediction error minimization. As cognitive, embodied agents, our directedness towards the world is what distinguishes us from non-living systems. Cognitive mechanisms extend beyond the neural domain, implicating the entire system comprising the nervous system, body, and relevant environmental aspects. The body plays three constitutive roles in cognition: regulating cognitive activity to link cognition and action, acting as a distributor of cognitive load, and constraining information processing by serving as a model of the environment. These roles highlight the intricate relationship between the body and cognition, emphasizing its indispensable role in cognitive processing.

### Active Inference Framework

Cognitive systems do not passively observe the world; instead, cognitive agents actively engage with and sample the environment to test their predictions regarding the causes of sensory data. The concept of active inference, derived from the free energy principle, outlines how agents aim to minimize variational free energy by testing and updating generative models through sequences of actions predicted to yield preferred outcomes, known as action policies. In other words, active inference is a way of understanding sentient behavior, emphasizing the implications of the free energy principle for understanding the intricate relationship between the body/actions and mind/cognition. Active inference is based on the premise that an agent's update rules for action, perception, policy selection, learning, and the encoding of uncertainty are all aiming for minimizing variational free energy. More specfically, it characterizes perception as the minimization of free energy with respect to sensory input and action as the minimization of the same free energy with respect to outbound action information. Likewise, this approach characterizes planning, and action in terms of probabilistic inference, emphasizing the brain's constant effort to minimize surprise or uncertainty by updating internal models based on sensory input. 

Active inference presupposes that agents have preferences for particular states that minimize uncertainty or expected surprise, as surprising states are inherently aversive (i.e. priors in Bayesian terms). Action policies and the subsequent adjustment of generative models are directed toward achieving preferred sensory outcomes and avoiding non-preferred ones. Along these lines, agentic preferences over sensory outcomes are typically treated as prior predictions, referred to as prior preferences. If the actual sensory outcome deviates from the preferred outcomes, it is considered surprising. Agents, when making decisions about potential action sequences, calibrate the expected surprise generated by different courses of action. After calibration, agents can infer the most likely action, a process sometimes described as planning or control as inference. The reaching preferred outcomes through action policies involves minimizing the expected divergence between preferred sensory outcomes and those anticipated when committing to a specific plan. The main aspect is that the actions are selected based on the agent's estimation of the likelihood of generating preferred sensory outcomes, often aligning with the agent's existing world model.

The empirical studies of the active inference framework have significantly contributed to our understanding of the brain. These studies have provided insights into the neural mechanisms underlying perception, learning, and decision-making, offering a unified theory at both computational and neural levels of description. For instance, [Schwartenbeck et al. (2015](https://www.sciencedirect.com/science/article/pii/S0306987714004423)) demonstrated how the behavior of these mechanisms can be explained by the activity of the brain in the case of addiction. Additionally, [Parr et al. (2021)](https://www.frontiersin.org/articles/10.3389/fnsys.2021.772641/full) and Ueltzhöffer (2018) have shown that active inference offers a principled treatment for epistemic exploration as a means of uncertainty reduction, information gain, and intrinsic motivation. Furthermore, Friston et al. (2017) have provided evidence supporting the active inference framework as a promising new computational framework grounded in contemporary neuroscience that can produce human-like perceptual-motor learning.


### Refrences

- [What does the free energy principle tell us about the brain?](https://gershmanlab.com/pubs/free_energy.pdf)
- [The free-energy principle: a unified brain theory ](https://www.uab.edu/medicine/cinl/images/KFriston_FreeEnergy_BrainTheory.pdf)
- [The Free-energy principle:a rough guide to the brain?](https://www.fil.ion.ucl.ac.uk/~karl/The%20free-energy%20principle%20-%20a%20rough%20guide%20to%20the%20brain.pdf) 
- [A free energy principle for the brain](https://www.fil.ion.ucl.ac.uk/~karl/A%20free%20energy%20principle%20for%20the%20brain.pdf)   
- [Active inference and learning](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5167251/)
- [Generalised free energy and active inference](https://link.springer.com/article/10.1007/s00422-019-00805-w)
- [Active Inference: The Free Energy Principle in Mind, Brain, and Behavior](https://direct.mit.edu/books/oa-monograph/5299/Active-InferenceThe-Free-Energy-Principle-in-Mind)
- [Active-InferenceThe-Free-Energy-Principle-in-Mind](https://direct.mit.edu/books/oa-monograph/5299/) 
- [Incorporating (variational) free energy models into mechanisms](https://link.springer.com/article/10.1007/s11229-023-04292-2) 
- [The Problem of Meaning: The Free Energy Principle and Artificial Agency](https://www.frontiersin.org/articles/10.3389/fnbot.2022.844773) 
- [“Surprise” and the Bayesian Brain: Implications for Psychotherapy Theory and Practice](https://www.frontiersin.org/articles/10.3389/fpsyg.2019.00592) 
- [Free energy: a user’s guide](https://link.springer.com/article/10.1007/s10539-022-09864-z)
- [Active Inference as a Computational Framework for Consciousness](https://link.springer.com/article/10.1007/s13164-021-00579-w) 
- [Understanding, Explanation, and Active Inference](https://www.frontiersin.org/articles/10.3389/fnsys.2021.772641/full)
- [A neural active inference model of perceptual-motor learning ](https://www.frontiersin.org/articles/10.3389/fncom.2023.1099593/full) 
  


